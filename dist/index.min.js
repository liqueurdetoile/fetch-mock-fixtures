!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("sinon"));else if("function"==typeof define&&define.amd)define(["sinon"],t);else{var r="object"==typeof exports?t(require("sinon")):t(e.sinon);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(e,t,r){"use strict";(function(t){var n=r(4),s=r(5),i=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,a=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],u={hash:1,query:1};function p(e){var r,n=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},s={},i=typeof(e=e||n);if("blob:"===e.protocol)s=new h(unescape(e.pathname),{});else if("string"===i)for(r in s=new h(e,{}),u)delete s[r];else if("object"===i){for(r in e)r in u||(s[r]=e[r]);void 0===s.slashes&&(s.slashes=o.test(e.href))}return s}function l(e){var t=i.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function h(e,t,r){if(!(this instanceof h))return new h(e,t,r);var i,o,u,c,f,d,w=a.slice(),y=typeof t,g=this,m=0;for("object"!==y&&"string"!==y&&(r=t,t=null),r&&"function"!=typeof r&&(r=s.parse),t=p(t),i=!(o=l(e||"")).protocol&&!o.slashes,g.slashes=o.slashes||i&&t.slashes,g.protocol=o.protocol||t.protocol||"",e=o.rest,o.slashes||(w[3]=[/(.*)/,"pathname"]);m<w.length;m++)"function"!=typeof(c=w[m])?(u=c[0],d=c[1],u!=u?g[d]=e:"string"==typeof u?~(f=e.indexOf(u))&&("number"==typeof c[2]?(g[d]=e.slice(0,f),e=e.slice(f+c[2])):(g[d]=e.slice(f),e=e.slice(0,f))):(f=u.exec(e))&&(g[d]=f[1],e=e.slice(0,f.index)),g[d]=g[d]||i&&c[3]&&t[d]||"",c[4]&&(g[d]=g[d].toLowerCase())):e=c(e);r&&(g.query=r(g.query)),i&&t.slashes&&"/"!==g.pathname.charAt(0)&&(""!==g.pathname||""!==t.pathname)&&(g.pathname=function(e,t){for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,s=r[n-1],i=!1,o=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),o++):o&&(0===n&&(i=!0),r.splice(n,1),o--);return i&&r.unshift(""),"."!==s&&".."!==s||r.push(""),r.join("/")}(g.pathname,t.pathname)),n(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(c=g.auth.split(":"),g.username=c[0]||"",g.password=c[1]||""),g.origin=g.protocol&&g.host&&"file:"!==g.protocol?g.protocol+"//"+g.host:"null",g.href=g.toString()}h.prototype={set:function(e,t,r){var i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||s.parse)(t)),i[e]=t;break;case"port":i[e]=t,n(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,/:\d+$/.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!r;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";i[e]=t.charAt(0)!==o?o+t:t}else i[e]=t;break;default:i[e]=t}for(var u=0;u<a.length;u++){var p=a[u];p[4]&&(i[p[1]]=i[p[1]].toLowerCase())}return i.origin=i.protocol&&i.host&&"file:"!==i.protocol?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=s.stringify);var t,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var i=n+(r.slashes?"//":"");return r.username&&(i+=r.username,r.password&&(i+=":"+r.password),i+="@"),i+=r.host+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(i+=r.hash),i}},h.extractProtocol=l,h.location=p,h.qs=s,e.exports=h}).call(this,r(3))},function(e,t){e.exports=l,e.exports.parse=s,e.exports.compile=function(e,t){return i(s(e,t))},e.exports.tokensToFunction=i,e.exports.tokensToRegExp=p;var r="/",n=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function s(e,t){for(var s,i=[],u=0,p=0,l="",h=t&&t.delimiter||r,c=t&&t.whitelist||void 0,f=!1;null!==(s=n.exec(e));){var d=s[0],w=s[1],y=s.index;if(l+=e.slice(p,y),p=y+d.length,w)l+=w[1],f=!0;else{var g="",m=s[2],x=s[3],v=s[4],b=s[5];if(!f&&l.length){var j=l.length-1,T=l[j];(!c||c.indexOf(T)>-1)&&(g=T,l=l.slice(0,j))}l&&(i.push(l),l="",f=!1);var S="+"===b||"*"===b,q="?"===b||"*"===b,O=x||v,E=g||h;i.push({name:m||u++,prefix:g,delimiter:E,optional:q,repeat:S,pattern:O?a(O):"[^"+o(E===h?E:E+h)+"]+?"})}}return(l||p<e.length)&&i.push(l+e.substr(p)),i}function i(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,n){for(var s="",i=n&&n.encode||encodeURIComponent,o=0;o<e.length;o++){var a=e[o];if("string"!=typeof a){var u,p=r?r[a.name]:void 0;if(Array.isArray(p)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===p.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var l=0;l<p.length;l++){if(u=i(p[l],a),!t[o].test(u))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');s+=(0===l?a.prefix:a.delimiter)+u}}else if("string"!=typeof p&&"number"!=typeof p&&"boolean"!=typeof p){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"))}else{if(u=i(String(p),a),!t[o].test(u))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+u+'"');s+=a.prefix+u}}else s+=a}return s}}function o(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function a(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e){return e&&e.sensitive?"":"i"}function p(e,t,n){for(var s=(n=n||{}).strict,i=!1!==n.start,a=!1!==n.end,p=n.delimiter||r,l=[].concat(n.endsWith||[]).map(o).concat("$").join("|"),h=i?"^":"",c=0;c<e.length;c++){var f=e[c];if("string"==typeof f)h+=o(f);else{var d=f.repeat?"(?:"+f.pattern+")(?:"+o(f.delimiter)+"(?:"+f.pattern+"))*":f.pattern;t&&t.push(f),f.optional?f.prefix?h+="(?:"+o(f.prefix)+"("+d+"))?":h+="("+d+")?":h+=o(f.prefix)+"("+d+")"}}if(a)s||(h+="(?:"+o(p)+")?"),h+="$"===l?"$":"(?="+l+")";else{var w=e[e.length-1],y="string"==typeof w?w[w.length-1]===p:void 0===w;s||(h+="(?:"+o(p)+"(?="+l+"))?"),y||(h+="(?="+o(p)+"|"+l+")")}return new RegExp(h,u(n))}function l(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],s=0;s<e.length;s++)n.push(l(e[s],t,r).source);return new RegExp("(?:"+n.join("|")+")",u(r))}(e,t,r):function(e,t,r){return p(s(e,r),t,r)}(e,t,r)}},function(t,r){t.exports=e},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,r){"use strict";var n,s=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}t.stringify=function(e,t){t=t||"";var r,i,o=[];for(i in"string"!=typeof t&&(t="?"),e)if(s.call(e,i)){if((r=e[i])||null!==r&&r!==n&&!isNaN(r)||(r=""),i=encodeURIComponent(i),r=encodeURIComponent(r),null===i||null===r)continue;o.push(i+"="+r)}return o.length?t+o.join("&"):""},t.parse=function(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);){var s=i(t[1]),o=i(t[2]);null===s||null===o||s in n||(n[s]=o)}return n}},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t);class s{constructor(e,t){n(this,"server",null),n(this,"body",null),n(this,"status",null),n(this,"statusText",null),n(this,"headers",null),n(this,"wrapper",!1),this.server=e,this.wrap=e.wrap,this.headers=t.headers||e.headers,this.headers instanceof Headers||(this.headers=new Headers(this.headers)),this.status=t.status||e.status,this.statusText=t.statusText||e.statusText,this.wrapper=t.wrapper||e.wrapper,this.body=t.body,t.initialized&&(this.initialized=t.initialized),t.destroyed&&(this.destroyed=t.destroyed)}get response(){return new Response(this.wrap(this.body),{headers:this.headers,status:this.status,statusText:this.statusText})}}var i=r(0),o=r.n(i),a=r(1),u=r.n(a),p=r(2),l=r.n(p);function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=class{constructor(e){h(this,"delay",0),h(this,"pattern",!1),h(this,"headers",new Headers({"content-type":"text/html"})),h(this,"status",200),h(this,"statusText","OK"),h(this,"wrapper",!1),e&&this.configure(e)}configure(e={}){return this.setDelay(e.delay).setHeaders(e.headers).setStatus(e.status).setStatusText(e.statusText).setWrapper(e.wrapper).setFixturePattern(e.pattern),this}reset(){return this.configure(),this}start(){return l.a.stub(window,"fetch"),this}stop(){return window.fetch.restore(),this}setDelay(e=0){return this.delay=e,this}setStatus(e=200){return this.status=e,this}setStatusText(e="OK"){return this.statusText=e,this}setHeaders(e={"content-type":"text/html"}){return e instanceof Headers?(this.headers=e,this):(this.headers=new Headers(e),this)}setWrapper(e=!1){return this.wrapper=e,this}setFixturePattern(e){return this.pattern=e,this}get url(){return o()(this.request.url).pathname}get query(){return o()(this.request.url,!0).query}get request(){return window.fetch.firstCall.args[0]instanceof Request?window.fetch.firstCall.args[0].clone():new Request(window.fetch.firstCall.args[0],window.fetch.lastCall.args[1])}get fixture(){let e=(this.pattern||this.url).split("/").filter(e=>e&&e.indexOf(":")<0),t=this.request.method.toLowerCase();return e.concat(t).join("/")}wrap(e){if(!e)return null;if(this.wrapper){if(this.wrapper instanceof Function)return this.wrapper(e);if("string"==typeof e)return this.wrapper.replace("%data%",e);let t=String(this.wrapper);for(let r in e)t=t.replace("%"+r+"%",e[r]);return t}return e}respondWith(e,t={}){return e instanceof Response?(window.fetch.callsFake(async()=>(this.delay&&await this.sleep(this.delay),e)),this):(t=Object.assign({headers:this.headers,status:this.status,statusText:this.statusText},t),window.fetch.callsFake(async()=>(this.delay&&await this.sleep(this.delay),new Response(this.wrap(e),t))),this)}respondWithStatus(e,t){return this.respondWith(t,{status:e})}respondWithJSON(e,t={}){return t.headers=t.headers||new Headers,t.headers.set("content-type","application/json"),this.respondWith(JSON.stringify(e),t)}respondWithFixture(){return window.fetch.callsFake(this._loadFixture.bind(this)),this}async sleep(e){await new Promise(t=>setTimeout(t,e))}_getFixtureParams(){throw new Error("Fixture finder have not been implemented. See readme for more informations.")}async _loadFixture(e){let t;if("string"==typeof e)try{const t=this._getFixtureParams();e=new s(this,t)}catch(e){return new Response(null,{status:404,statusText:e.toString()})}else e=new s(this,e);let r={};if(this.pattern){const e=[],t=u()(this.pattern,e).exec(this.url);for(let n=0;n<e.length;n++)r[e[n].name]=t[n+1]}return e.initialized instanceof Function&&await e.initialized(r),this.delay&&await this.sleep(this.delay),t=e.response,e.destroyed instanceof Function&&await e.destroyed(),t}};r.d(t,"Fixture",function(){return s}),r.d(t,"Server",function(){return c});t.default=c}])});