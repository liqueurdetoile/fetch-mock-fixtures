!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("sinon"));else if("function"==typeof define&&define.amd)define(["sinon"],e);else{var r="object"==typeof exports?e(require("sinon")):e(t.sinon);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,function(t){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)}([function(t,e,r){(function(t,r){var n=200,s="__lodash_hash_undefined__",o=1,a=2,i=9007199254740991,u="[object Arguments]",c="[object Array]",l="[object AsyncFunction]",h="[object Boolean]",f="[object Date]",p="[object Error]",d="[object Function]",y="[object GeneratorFunction]",_="[object Map]",b="[object Number]",w="[object Null]",g="[object Object]",v="[object Proxy]",m="[object RegExp]",x="[object Set]",j="[object String]",O="[object Symbol]",k="[object Undefined]",C="[object ArrayBuffer]",E="[object DataView]",R=/^\[object .+?Constructor\]$/,S=/^(?:0|[1-9]\d*)$/,q={};q["[object Float32Array]"]=q["[object Float64Array]"]=q["[object Int8Array]"]=q["[object Int16Array]"]=q["[object Int32Array]"]=q["[object Uint8Array]"]=q["[object Uint8ClampedArray]"]=q["[object Uint16Array]"]=q["[object Uint32Array]"]=!0,q[u]=q[c]=q[C]=q[h]=q[E]=q[f]=q[p]=q[d]=q[_]=q[b]=q[g]=q[m]=q[x]=q[j]=q["[object WeakMap]"]=!1;var P="object"==typeof t&&t&&t.Object===Object&&t,F="object"==typeof self&&self&&self.Object===Object&&self,A=P||F||Function("return this")(),T=e&&!e.nodeType&&e,z=T&&"object"==typeof r&&r&&!r.nodeType&&r,U=z&&z.exports===T,I=U&&P.process,M=function(){try{return I&&I.binding&&I.binding("util")}catch(t){}}(),$=M&&M.isTypedArray;function B(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function N(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function L(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var D,H,K,W=Array.prototype,J=Function.prototype,V=Object.prototype,Z=A["__core-js_shared__"],G=J.toString,Y=V.hasOwnProperty,Q=(D=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"",X=V.toString,tt=RegExp("^"+G.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=U?A.Buffer:void 0,rt=A.Symbol,nt=A.Uint8Array,st=V.propertyIsEnumerable,ot=W.splice,at=rt?rt.toStringTag:void 0,it=Object.getOwnPropertySymbols,ut=et?et.isBuffer:void 0,ct=(H=Object.keys,K=Object,function(t){return H(K(t))}),lt=Mt(A,"DataView"),ht=Mt(A,"Map"),ft=Mt(A,"Promise"),pt=Mt(A,"Set"),dt=Mt(A,"WeakMap"),yt=Mt(Object,"create"),_t=Lt(lt),bt=Lt(ht),wt=Lt(ft),gt=Lt(pt),vt=Lt(dt),mt=rt?rt.prototype:void 0,xt=mt?mt.valueOf:void 0;function jt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ot(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ct(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new kt;++e<r;)this.add(t[e])}function Et(t){var e=this.__data__=new Ot(t);this.size=e.size}function Rt(t,e){var r=Kt(t),n=!r&&Ht(t),s=!r&&!n&&Wt(t),o=!r&&!n&&!s&&Yt(t),a=r||n||s||o,i=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],u=i.length;for(var c in t)!e&&!Y.call(t,c)||a&&("length"==c||s&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Nt(c,u))||i.push(c);return i}function St(t,e){for(var r=t.length;r--;)if(Dt(t[r][0],e))return r;return-1}function qt(t){return null==t?void 0===t?k:w:at&&at in Object(t)?function(t){var e=Y.call(t,at),r=t[at];try{t[at]=void 0;var n=!0}catch(t){}var s=X.call(t);n&&(e?t[at]=r:delete t[at]);return s}(t):function(t){return X.call(t)}(t)}function Pt(t){return Gt(t)&&qt(t)==u}function Ft(t,e,r,n,s){return t===e||(null==t||null==e||!Gt(t)&&!Gt(e)?t!=t&&e!=e:function(t,e,r,n,s,i){var l=Kt(t),d=Kt(e),y=l?c:Bt(t),w=d?c:Bt(e),v=(y=y==u?g:y)==g,k=(w=w==u?g:w)==g,R=y==w;if(R&&Wt(t)){if(!Wt(e))return!1;l=!0,v=!1}if(R&&!v)return i||(i=new Et),l||Yt(t)?zt(t,e,r,n,s,i):function(t,e,r,n,s,i,u){switch(r){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case C:return!(t.byteLength!=e.byteLength||!i(new nt(t),new nt(e)));case h:case f:case b:return Dt(+t,+e);case p:return t.name==e.name&&t.message==e.message;case m:case j:return t==e+"";case _:var c=N;case x:var l=n&o;if(c||(c=L),t.size!=e.size&&!l)return!1;var d=u.get(t);if(d)return d==e;n|=a,u.set(t,e);var y=zt(c(t),c(e),n,s,i,u);return u.delete(t),y;case O:if(xt)return xt.call(t)==xt.call(e)}return!1}(t,e,y,r,n,s,i);if(!(r&o)){var S=v&&Y.call(t,"__wrapped__"),q=k&&Y.call(e,"__wrapped__");if(S||q){var P=S?t.value():t,F=q?e.value():e;return i||(i=new Et),s(P,F,r,n,i)}}if(!R)return!1;return i||(i=new Et),function(t,e,r,n,s,a){var i=r&o,u=Ut(t),c=u.length,l=Ut(e).length;if(c!=l&&!i)return!1;for(var h=c;h--;){var f=u[h];if(!(i?f in e:Y.call(e,f)))return!1}var p=a.get(t);if(p&&a.get(e))return p==e;var d=!0;a.set(t,e),a.set(e,t);for(var y=i;++h<c;){f=u[h];var _=t[f],b=e[f];if(n)var w=i?n(b,_,f,e,t,a):n(_,b,f,t,e,a);if(!(void 0===w?_===b||s(_,b,r,n,a):w)){d=!1;break}y||(y="constructor"==f)}if(d&&!y){var g=t.constructor,v=e.constructor;g!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v)&&(d=!1)}return a.delete(t),a.delete(e),d}(t,e,r,n,s,i)}(t,e,r,n,Ft,s))}function At(t){return!(!Zt(t)||(e=t,Q&&Q in e))&&(Jt(t)?tt:R).test(Lt(t));var e}function Tt(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||V,e!==n)return ct(t);var e,r,n,s=[];for(var o in Object(t))Y.call(t,o)&&"constructor"!=o&&s.push(o);return s}function zt(t,e,r,n,s,i){var u=r&o,c=t.length,l=e.length;if(c!=l&&!(u&&l>c))return!1;var h=i.get(t);if(h&&i.get(e))return h==e;var f=-1,p=!0,d=r&a?new Ct:void 0;for(i.set(t,e),i.set(e,t);++f<c;){var y=t[f],_=e[f];if(n)var b=u?n(_,y,f,e,t,i):n(y,_,f,t,e,i);if(void 0!==b){if(b)continue;p=!1;break}if(d){if(!B(e,function(t,e){if(o=e,!d.has(o)&&(y===t||s(y,t,r,n,i)))return d.push(e);var o})){p=!1;break}}else if(y!==_&&!s(y,_,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}function Ut(t){return function(t,e,r){var n=e(t);return Kt(t)?n:function(t,e){for(var r=-1,n=e.length,s=t.length;++r<n;)t[s+r]=e[r];return t}(n,r(t))}(t,Qt,$t)}function It(t,e){var r,n,s=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?s["string"==typeof e?"string":"hash"]:s.map}function Mt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return At(r)?r:void 0}jt.prototype.clear=function(){this.__data__=yt?yt(null):{},this.size=0},jt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},jt.prototype.get=function(t){var e=this.__data__;if(yt){var r=e[t];return r===s?void 0:r}return Y.call(e,t)?e[t]:void 0},jt.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:Y.call(e,t)},jt.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=yt&&void 0===e?s:e,this},Ot.prototype.clear=function(){this.__data__=[],this.size=0},Ot.prototype.delete=function(t){var e=this.__data__,r=St(e,t);return!(r<0||(r==e.length-1?e.pop():ot.call(e,r,1),--this.size,0))},Ot.prototype.get=function(t){var e=this.__data__,r=St(e,t);return r<0?void 0:e[r][1]},Ot.prototype.has=function(t){return St(this.__data__,t)>-1},Ot.prototype.set=function(t,e){var r=this.__data__,n=St(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},kt.prototype.clear=function(){this.size=0,this.__data__={hash:new jt,map:new(ht||Ot),string:new jt}},kt.prototype.delete=function(t){var e=It(this,t).delete(t);return this.size-=e?1:0,e},kt.prototype.get=function(t){return It(this,t).get(t)},kt.prototype.has=function(t){return It(this,t).has(t)},kt.prototype.set=function(t,e){var r=It(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Ct.prototype.add=Ct.prototype.push=function(t){return this.__data__.set(t,s),this},Ct.prototype.has=function(t){return this.__data__.has(t)},Et.prototype.clear=function(){this.__data__=new Ot,this.size=0},Et.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Et.prototype.get=function(t){return this.__data__.get(t)},Et.prototype.has=function(t){return this.__data__.has(t)},Et.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Ot){var s=r.__data__;if(!ht||s.length<n-1)return s.push([t,e]),this.size=++r.size,this;r=this.__data__=new kt(s)}return r.set(t,e),this.size=r.size,this};var $t=it?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,s=0,o=[];++r<n;){var a=t[r];e(a,r,t)&&(o[s++]=a)}return o}(it(t),function(e){return st.call(t,e)}))}:function(){return[]},Bt=qt;function Nt(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||S.test(t))&&t>-1&&t%1==0&&t<e}function Lt(t){if(null!=t){try{return G.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Dt(t,e){return t===e||t!=t&&e!=e}(lt&&Bt(new lt(new ArrayBuffer(1)))!=E||ht&&Bt(new ht)!=_||ft&&"[object Promise]"!=Bt(ft.resolve())||pt&&Bt(new pt)!=x||dt&&"[object WeakMap]"!=Bt(new dt))&&(Bt=function(t){var e=qt(t),r=e==g?t.constructor:void 0,n=r?Lt(r):"";if(n)switch(n){case _t:return E;case bt:return _;case wt:return"[object Promise]";case gt:return x;case vt:return"[object WeakMap]"}return e});var Ht=Pt(function(){return arguments}())?Pt:function(t){return Gt(t)&&Y.call(t,"callee")&&!st.call(t,"callee")},Kt=Array.isArray;var Wt=ut||function(){return!1};function Jt(t){if(!Zt(t))return!1;var e=qt(t);return e==d||e==y||e==l||e==v}function Vt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}function Zt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Gt(t){return null!=t&&"object"==typeof t}var Yt=$?function(t){return function(e){return t(e)}}($):function(t){return Gt(t)&&Vt(t.length)&&!!q[qt(t)]};function Qt(t){return null!=(e=t)&&Vt(e.length)&&!Jt(e)?Rt(t):Tt(t);var e}r.exports=function(t,e){return Ft(t,e)}}).call(this,r(1),r(5)(t))},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(e,r){e.exports=t},function(t,e){t.exports=l,t.exports.parse=s,t.exports.compile=function(t,e){return o(s(t,e))},t.exports.tokensToFunction=o,t.exports.tokensToRegExp=c;var r="/",n=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function s(t,e){for(var s,o=[],u=0,c=0,l="",h=e&&e.delimiter||r,f=e&&e.whitelist||void 0,p=!1;null!==(s=n.exec(t));){var d=s[0],y=s[1],_=s.index;if(l+=t.slice(c,_),c=_+d.length,y)l+=y[1],p=!0;else{var b="",w=s[2],g=s[3],v=s[4],m=s[5];if(!p&&l.length){var x=l.length-1,j=l[x];(!f||f.indexOf(j)>-1)&&(b=j,l=l.slice(0,x))}l&&(o.push(l),l="",p=!1);var O="+"===m||"*"===m,k="?"===m||"*"===m,C=g||v,E=b||h;o.push({name:w||u++,prefix:b,delimiter:E,optional:k,repeat:O,pattern:C?i(C):"[^"+a(E===h?E:E+h)+"]+?"})}}return(l||c<t.length)&&o.push(l+t.substr(c)),o}function o(t){for(var e=new Array(t.length),r=0;r<t.length;r++)"object"==typeof t[r]&&(e[r]=new RegExp("^(?:"+t[r].pattern+")$"));return function(r,n){for(var s="",o=n&&n.encode||encodeURIComponent,a=0;a<t.length;a++){var i=t[a];if("string"!=typeof i){var u,c=r?r[i.name]:void 0;if(Array.isArray(c)){if(!i.repeat)throw new TypeError('Expected "'+i.name+'" to not repeat, but got array');if(0===c.length){if(i.optional)continue;throw new TypeError('Expected "'+i.name+'" to not be empty')}for(var l=0;l<c.length;l++){if(u=o(c[l],i),!e[a].test(u))throw new TypeError('Expected all "'+i.name+'" to match "'+i.pattern+'"');s+=(0===l?i.prefix:i.delimiter)+u}}else if("string"!=typeof c&&"number"!=typeof c&&"boolean"!=typeof c){if(!i.optional)throw new TypeError('Expected "'+i.name+'" to be '+(i.repeat?"an array":"a string"))}else{if(u=o(String(c),i),!e[a].test(u))throw new TypeError('Expected "'+i.name+'" to match "'+i.pattern+'", but got "'+u+'"');s+=i.prefix+u}}else s+=i}return s}}function a(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function i(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function u(t){return t&&t.sensitive?"":"i"}function c(t,e,n){for(var s=(n=n||{}).strict,o=!1!==n.start,i=!1!==n.end,c=n.delimiter||r,l=[].concat(n.endsWith||[]).map(a).concat("$").join("|"),h=o?"^":"",f=0;f<t.length;f++){var p=t[f];if("string"==typeof p)h+=a(p);else{var d=p.repeat?"(?:"+p.pattern+")(?:"+a(p.delimiter)+"(?:"+p.pattern+"))*":p.pattern;e&&e.push(p),p.optional?p.prefix?h+="(?:"+a(p.prefix)+"("+d+"))?":h+="("+d+")?":h+=a(p.prefix)+"("+d+")"}}if(i)s||(h+="(?:"+a(c)+")?"),h+="$"===l?"$":"(?="+l+")";else{var y=t[t.length-1],_="string"==typeof y?y[y.length-1]===c:void 0===y;s||(h+="(?:"+a(c)+"(?="+l+"))?"),_||(h+="(?="+a(c)+"|"+l+")")}return new RegExp(h,u(n))}function l(t,e,r){return t instanceof RegExp?function(t,e){if(!e)return t;var r=t.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)e.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,r){for(var n=[],s=0;s<t.length;s++)n.push(l(t[s],e,r).source);return new RegExp("(?:"+n.join("|")+")",u(r))}(t,e,r):function(t,e,r){return c(s(t,r),e,r)}(t,e,r)}},function(t,e,r){"use strict";(function(e){var n=r(6),s=r(7),o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,a=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,i=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function u(t){return(t||"").toString().replace(i,"")}var c=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],l={hash:1,query:1};function h(t){var r,n=("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{}).location||{},s={},a=typeof(t=t||n);if("blob:"===t.protocol)s=new p(unescape(t.pathname),{});else if("string"===a)for(r in s=new p(t,{}),l)delete s[r];else if("object"===a){for(r in t)r in l||(s[r]=t[r]);void 0===s.slashes&&(s.slashes=o.test(t.href))}return s}function f(t){t=u(t);var e=a.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],rest:e[3]}}function p(t,e,r){if(t=u(t),!(this instanceof p))return new p(t,e,r);var o,a,i,l,d,y,_=c.slice(),b=typeof e,w=this,g=0;for("object"!==b&&"string"!==b&&(r=e,e=null),r&&"function"!=typeof r&&(r=s.parse),e=h(e),o=!(a=f(t||"")).protocol&&!a.slashes,w.slashes=a.slashes||o&&e.slashes,w.protocol=a.protocol||e.protocol||"",t=a.rest,a.slashes||(_[3]=[/(.*)/,"pathname"]);g<_.length;g++)"function"!=typeof(l=_[g])?(i=l[0],y=l[1],i!=i?w[y]=t:"string"==typeof i?~(d=t.indexOf(i))&&("number"==typeof l[2]?(w[y]=t.slice(0,d),t=t.slice(d+l[2])):(w[y]=t.slice(d),t=t.slice(0,d))):(d=i.exec(t))&&(w[y]=d[1],t=t.slice(0,d.index)),w[y]=w[y]||o&&l[3]&&e[y]||"",l[4]&&(w[y]=w[y].toLowerCase())):t=l(t);r&&(w.query=r(w.query)),o&&e.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==e.pathname)&&(w.pathname=function(t,e){if(""===t)return e;for(var r=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=r.length,s=r[n-1],o=!1,a=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),a++):a&&(0===n&&(o=!0),r.splice(n,1),a--);return o&&r.unshift(""),"."!==s&&".."!==s||r.push(""),r.join("/")}(w.pathname,e.pathname)),n(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(l=w.auth.split(":"),w.username=l[0]||"",w.password=l[1]||""),w.origin=w.protocol&&w.host&&"file:"!==w.protocol?w.protocol+"//"+w.host:"null",w.href=w.toString()}p.prototype={set:function(t,e,r){var o=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(r||s.parse)(e)),o[t]=e;break;case"port":o[t]=e,n(e,o.protocol)?e&&(o.host=o.hostname+":"+e):(o.host=o.hostname,o[t]="");break;case"hostname":o[t]=e,o.port&&(e+=":"+o.port),o.host=e;break;case"host":o[t]=e,/:\d+$/.test(e)?(e=e.split(":"),o.port=e.pop(),o.hostname=e.join(":")):(o.hostname=e,o.port="");break;case"protocol":o.protocol=e.toLowerCase(),o.slashes=!r;break;case"pathname":case"hash":if(e){var a="pathname"===t?"/":"#";o[t]=e.charAt(0)!==a?a+e:e}else o[t]=e;break;default:o[t]=e}for(var i=0;i<c.length;i++){var u=c[i];u[4]&&(o[u[1]]=o[u[1]].toLowerCase())}return o.origin=o.protocol&&o.host&&"file:"!==o.protocol?o.protocol+"//"+o.host:"null",o.href=o.toString(),o},toString:function(t){t&&"function"==typeof t||(t=s.stringify);var e,r=this,n=r.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(r.slashes?"//":"");return r.username&&(o+=r.username,r.password&&(o+=":"+r.password),o+="@"),o+=r.host+r.pathname,(e="object"==typeof r.query?t(r.query):r.query)&&(o+="?"!==e.charAt(0)?"?"+e:e),r.hash&&(o+=r.hash),o}},p.extractProtocol=f,p.location=h,p.trimLeft=u,p.qs=s,t.exports=p}).call(this,r(1))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";t.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},function(t,e,r){"use strict";var n,s=Object.prototype.hasOwnProperty;function o(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}e.stringify=function(t,e){e=e||"";var r,o,a=[];for(o in"string"!=typeof e&&(e="?"),t)if(s.call(t,o)){if((r=t[o])||null!==r&&r!==n&&!isNaN(r)||(r=""),o=encodeURIComponent(o),r=encodeURIComponent(r),null===o||null===r)continue;a.push(o+"="+r)}return a.length?e+a.join("&"):""},e.parse=function(t){for(var e,r=/([^=?&]+)=?([^&]*)/g,n={};e=r.exec(t);){var s=o(e[1]),a=o(e[2]);null===s||null===a||s in n||(n[s]=a)}return n}},function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.r(e);class s{constructor(){n(this,"_history",[]),n(this,"_call",null),n(this,"_target",null)}push(t,e){this._history.push({request:t,response:e})}get request(){if(this._call){const t=this._history[this._call-1].request;return this._call=null,t}return this._target="request",this}get response(){if(this._call){const t=this._history[this._call-1].response;return this._call=null,t}return this._target="response",this}get first(){return this.atCall(1)}get second(){return this.atCall(2)}get third(){return this.atCall(3)}get last(){return this.atCall(this._history.length)}atCall(t){if(this._target){const e=this._history[t-1][this._target];return this._target=null,e}return this._call=t,this}all(){if(this._target){const t=this._history.map(t=>t[this._target]);return this._target=null,t}return this._history}reset(){this._history=[],this._call=null,this._target=null}}class o extends Error{constructor(t,e=null){super(t),this.previous=e,Error.captureStackTrace&&Error.captureStackTrace(this,o)}toString(){return"FMF error: ".concat(this.message)}}var a={default:{body:"Hello world !",delay:0,headers:{"content-type":"text/html"},status:200,statusText:"OK"},json:{headers:{"content-type":"application/json"},wrapper:t=>JSON.stringify(t)},204:{body:null,headers:{"content-type":"text/html"},status:204,statusText:"No Content"},400:{body:null,headers:{"content-type":"text/html"},status:400,statusText:"Bad Request"},401:{body:null,headers:{"content-type":"text/html"},status:401,statusText:"Unauthorized"},403:{body:null,headers:{"content-type":"text/html"},status:403,statusText:"Forbidden"},404:{body:null,headers:{"content-type":"text/html"},status:404,statusText:"Not found"},500:{body:null,headers:{"content-type":"text/html"},status:500,statusText:"Internal Server Error"}},i=r(2),u=r.n(i);function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=class{constructor(){c(this,"_fixtures",[]),c(this,"_throwOnError",!1),c(this,"_warnOnError",!0),c(this,"_presets",{}),c(this,"history",new s);for(let t in a)this._presets[t]=new p(this,t,a[t])}start(){return this.running||(u.a.stub(window,"fetch"),this.stub.callsFake(this._processRequest.bind(this))),this}stop(t=!1){return this.running&&window.fetch.restore(),t&&this.reset(),this}reset(t=!0){return this.running&&t&&this.stub.resetHistory(),this.history.reset(),this._fixtures=[],this}warnOnError(t){return this._warnOnError=!!t,this}throwOnError(t){return this._throwOnError=!!t,this}warn(t){console.warn(t.toString())}get running(){return window.fetch.reset instanceof Function}get stub(){if(this.running)return window.fetch;throw new o("Server is not started")}preset(t,e={}){if(this._presets[t])return this._presets[t].set(e);let r=new p(this,t,e);return this._presets[t]=r,r}import(t){t instanceof Array||(t=[t]);for(let e of t)if(e instanceof R)e.server=this,this._fixtures.push(e);else{if(!(e instanceof Object))throw new o("Invalid fixture provided");{let t=new R(this),r=e.on||e.when;if(!e.respond)throw new o("Fixture provided as object must have a respond property");r&&t.on.equal(r),t.respond.set(e.respond),this._fixtures.push(t)}}return this}get on(){const t=new R(this);return this._fixtures.push(t),t._mode="on",t.on}get when(){return this.on}get fallback(){return this._getDefaultFixture()}_getDefaultFixture(){const t=this._fixtures.findIndex(t=>null===t._matcher);if(t>=0)return this._fixtures[t];const e=new R(this);return this._fixtures.push(e),e}_processRespond(t={}){return"respond"===t._mode&&(t=this._getDefaultFixture()),t._mode="respond",t}get respond(){return this._getDefaultFixture()}async _findFixture(t){let e=[],r=null;if(!this._fixtures.length)throw new o("No fixtures defined");for(let n of this._fixtures)null!==n._matcher?await n.match(t)&&e.push(n):r=n;if(!e.length){if(!r)throw new o("Unable to find a matching fixture for the current request and no fixture is set as fallback");e[0]=r}return e.length>1&&this.warn("FMF : Server found ".concat(e.length,' fixtures matching the request "').concat(t.url,'". Using the first one.')),e[0]}async _processRequest(t,e){try{t=new F(t,e);let r=await this._findFixture(t.clone()),n=await r.getResponse(t.clone());return this.history.push(t.clone(),n.clone()),n}catch(t){if(this._warnOnError&&this.warn(t),this._throwOnError)throw t instanceof o?t:new o("Request process failure",t);return new Response(t.stack,{"content-type":"text/html",status:500,statusText:t.toString()})}}get calls(){return this.stub.callCount}get request(){return this.history.last.request}get response(){return this.history.last.response}};function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=class{constructor(t=null){h(this,"server",null),h(this,"_any",{}),h(this,"_responseKeys",["body","delay","headers","status","statusText","wrapper","pattern","before","after"]),this.server=t}get with(){return this}get and(){return this}set(t={}){if(!(t instanceof Object))throw new Error("Response set must be an object");for(let e in t){if(!this._responseKeys.includes(e))throw new o('Invalid key "'.concat(e,'" for response set configuration'));this[e](t[e])}return this}body(t){let e=this._getCurrentResponseSet();return!1===t?delete e.body:e.body=t,this}delay(t){let e=this._getCurrentResponseSet();return!1===t?delete e.delay:e.delay=parseInt(t,10),this}headers(t){if(t&&!(t instanceof Object||t instanceof Headers))throw new Error("Headers must be an object or an Headers instance");t instanceof Object&&(t=new Headers(t));let e=this._getCurrentResponseSet();return!1===t?delete e.headers:e.headers=t,this}status(t){let e=this._getCurrentResponseSet();return!1===t?delete e.status:e.status=parseInt(t,10),this}statusText(t){let e=this._getCurrentResponseSet();return!1===t?delete e.statusText:e.statusText=t,this}wrapper(t){let e=this._getCurrentResponseSet();return!1===t?delete e.wrapper:e.wrapper=t,this}pattern(t){let e=this._getCurrentResponseSet();return!1===t?delete e.pattern:e.pattern=t,this}before(t){if(t&&!(t instanceof Function))throw new Error("Before hook must be a function");let e=this._getCurrentResponseSet();return!1===t?delete e.before:e.before=t,this}after(t){if(t&&!(t instanceof Function))throw new Error("Before hook must be a function");let e=this._getCurrentResponseSet();return!1===t?delete e.after:e.after=t,this}};var p=class extends f{constructor(t,e,r){if(super(t),!e)throw new Error("You must provide a name to the preset");if(this.name=e,r){if(!(r instanceof Object))throw new Error("Preset options must be provided as an object");this.set(r)}}_getCurrentResponseSet(){return this._any}},d=r(0),y=r.n(d);function _(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class b{constructor(t,e){_(this,"_key",null),_(this,"_not",!1),_(this,"_evaluate",null),this._key=t,this._matcher=e}get is(){return this}get not(){return this._not=!this._not,this}async _equal(t,e,r){if(e instanceof Function)return await e(t,this._key,r);if(e instanceof RegExp)return e.test(t);try{return t=JSON.parse(t),y()(t,e)}catch(r){return y()(t,e)}}equal(t){return this._evaluate=(async e=>{let r=e[this._key];return await this._equal(r,t,e)}),this._matcher}async process(t,e){let r=await this._evaluate(t,e);return this._not?!r:r}}class w extends b{}class g extends b{constructor(t,e,r){super(t,e),function(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(this,"_type",null),this._type=r}async _processBody(t){let e;switch(this._type.toLowerCase()){case"text":try{e=await t.clone().text()}catch(t){throw new o("Unable to parse body as blob",t)}break;case"json":try{e=await t.clone().json()}catch(t){throw new o("Unable to parse body as JSON",t)}break;case"formdata":try{e=await t.clone().formData()}catch(t){throw new o("Unable to parse body as FormData",t)}break;case"arraybuffer":try{e=await t.clone().arrayBuffer()}catch(t){throw new o("Unable to parse body as Blob",t)}break;case"blob":try{e=await t.clone().blob()}catch(t){throw new o("Unable to parse body as Blob",t)}break;default:throw new o("Unknown body decoder callback")}return e}equal(t){return this._evaluate=(async e=>{const r=await this._processBody(e);return await this._equal(r,t,e)}),this._matcher}}class v extends b{constructor(t,e,r){super(t,e),function(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(this,"_name",null),this._name=r}equal(t){return this._evaluate=(async e=>{const r=e.headers;if(!(r instanceof Headers))throw new o("Unable to extract headers from request");return await this._equal(this._name?r.get(this._name):r,t)}),this._matcher}}class m extends b{}class x extends b{}function j(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var O=class{constructor(t){j(this,"_processors",[]),j(this,"_requestKeys",["method","url","headers","destination","referrer","referrerPolicy","mode","credentials","redirect","integrity","cache","protocol","slashes","auth","username","password","host","hostname","port","pathname","query","hash","href","method","header","body"]),this.fixture=t}get on(){return this.fixture.on}get and(){return this}get respond(){return this.fixture.respond}getProcessor(t){let e;switch(t){case"headers":e=new v(t,this);break;case"query":e=new m(t,this);break;case"slashes":e=new w(t,this);break;case"auth":case"cache":case"credentials":case"destination":case"hash":case"href":case"host":case"hostname":case"integrity":case"mode":case"method":case"password":case"pathname":case"port":case"protocol":case"redirect":case"referrer":case"referrerPolicy":case"url":case"username":e=new x(t,this);break;default:throw new o('Unsupported request parameter "'.concat(t,'" to check'))}return this._processors.push(e),e}body(t="text"){const e=new g("headers",this,t);return this._processors.push(e),e}header(t){const e=new v("headers",this,t);return this._processors.push(e),e}async match(t,e){for(let r of this._processors)if(!await r.process(t,e))return!1;return!0}equal(t){if(!(t instanceof Object))throw new Error("Request conditions set must be an object");for(let e in t){if(!this._requestKeys.includes(e))throw new o('Invalid key "'.concat(e,'" for request conditions configuration'));this[e].equal(t[e])}return this}},k=r(3),C=r.n(k);function E(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var R=class extends f{constructor(t){super(t),E(this,"calls",0),E(this,"ownCalls",[]),E(this,"globalCalls",[]),E(this,"_callnum",null),E(this,"_matcher",null),E(this,"_ownCall",!1),E(this,"_responseKeys",["body","delay","headers","status","statusText","wrapper","pattern","before","after","preset"])}get on(){return"respond"===this._mode?this.server.on:(this._matcher=this._matcher||new O(this),new Proxy(this._matcher,{get:(t,e)=>e in t?t[e]:t.getProcessor(e)}))}get when(){return this.on}get respond(){return this.server?this.server._processRespond(this):this}_getCurrentResponseSet(){return null!==this._callnum?this._ownCall?(this.ownCalls[this._callnum]=this.ownCalls[this._callnum]||{},this.ownCalls[this._callnum]):(this.globalCalls[this._callnum]=this.globalCalls[this._callnum]||{},this.globalCalls[this._callnum]):(this._any=this._any,this._any)}get to(){return this}get fallback(){return this.server.fallback}firstCall(t=!1){return this._callnum=1,this._ownCall=t,this}secondCall(t=!1){return this._callnum=2,this._ownCall=t,this}thirdCall(t=!1){return this._callnum=3,this._ownCall=t,this}call(t,e){return this._callnum=parseInt(t,10),this._ownCall=e,this}get any(){return this._callnum=null,this._ownCall=!1,this}preset(t){let e=this._getCurrentResponseSet();return t?e.preset=t:delete e.preset,this}async match(t,e){return!this._matcher||await this._matcher.match(t,e)}async sleep(t){await new Promise(e=>setTimeout(e,t))}extractParams(t,e){const r={},n=[],s=C()(e,n).exec(t);for(let t=0;t<n.length;t++){let e=n[t].name,o=s[t+1];r[e]=o}return r}wrap(t,e){return e instanceof Function?e(t):t||null}getPath(t,e){let r=(e.pattern||t.pathname).split("/").filter(t=>t&&t.indexOf(":")<0),n=t.method.toLowerCase();return r.concat(n).join("/")}_exceptionManagement(t,e){if(t instanceof Error||"string"==typeof t)throw new o(e,t);if(t instanceof Response)return t;if(t instanceof p){let{body:e,headers:r,status:n,statusText:s}=t._any;return new Response(e,{headers:r,status:n,statusText:s})}if(t instanceof Object){let{body:e,headers:r,status:n,statusText:s}=t;return new Response(e,{headers:r,status:n,statusText:s})}}async _buildResponse(t,e){if(e.before instanceof Function)try{let r=await e.before.call(this,this.server,t,e);r&&(e=r)}catch(t){return this._exceptionManagement(t,"Unable to process before callback")}let r=e.pattern?this.extractParams(t.pathname,e.pattern):{};try{e.body instanceof Function&&(e.body=await e.body.call(this,r,{request:t,response:e,server:this.server}))}catch(t){return this._exceptionManagement(t,"Unable to process body callback")}if(e.preset){let t=this.server._presets[e.preset];if(!t)throw new o("Unable to apply preset. Preset ".concat(e.preset," is not defined"));e=Object.assign(e,t._any)}let{body:n,headers:s,status:a,statusText:i,wrapper:u}=e;const c=new Response(this.wrap(n,u),{headers:s,status:a,statusText:i});try{e.after instanceof Function&&await e.after.call(this,this.server,c)}catch(t){return this._exceptionManagement(t,"Unable to process after callback")}return e.delay&&await this.sleep(e.delay),c}getResponse(t){const e=++this.calls,r=this.server.calls;return this._buildResponse(t,this.ownCalls[e]||this.globalCalls[r]||this._any)}},S=r(4),q=r.n(S);class P extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Request)){constructor(t,e){super(t,e);const r=q()(this.url,!0);for(let t in r)Object.defineProperty(this,t,{enumerable:!0,value:r[t]})}clone(){return new P(super.clone())}}var F=P;r.d(e,"Fixture",function(){return R}),r.d(e,"FMFRequest",function(){return F}),r.d(e,"Preset",function(){return p}),r.d(e,"Server",function(){return l}),r.d(e,"presets",function(){return a});e.default=l}])});